webpackJsonp([7],{CVS6:function(t,e){},eBhI:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("Cz8s"),i=a("p/61"),s=a("s8Ph"),o=(a("mtWM"),{name:"SearchResult",data:function(){return{totalPage:10,searchText:"",searchResults:[],searchTextShow:"",selectedDatabasePrice:"",selectedDatabase:null,selectedMiniDatabase:null,selectedDatabaseName:"",selectedCategory:null,selectedCategoryName:"",selectedMiniCategory:null,selectedMiniCategoryName:"",CategoryObjMinID:10086,DatabaseObj:{},CategoryObj:{},MiniCategoryObj:{},CategoryAll:{},keyWordList:{},pageSize:30,currentPage:0,inputPage:1,hoveredCategoryId:null}},created:function(){var t=this.$route.query.q;this.searchText=t;var e=this.$route.query.Database;this.selectedDatabase=e,this.selectedCategory=e,this.getCategory(),this.listMiniCategory()},mounted:function(){},computed:{currentPageData:function(){var t=this.currentPage*this.pageSize,e=t+this.pageSize;return this.searchResults.slice(t,e)},formattedText:function(){var t=this;return function(e){return""==t.searchTextShow?e:t.highlight(e,t.searchTextShow)}}},methods:{highlight:function(t,e){return t.replace(new RegExp(e,"g"),function(t){return'<span style="color: red; font-weight: bold;">'+t+"</span>"})},getTotalPage:function(){this.totalPage=Math.ceil(this.searchResults.length/this.pageSize)},prevPage:function(){this.currentPage>0&&this.currentPage--},nextPage:function(){this.currentPage<Math.ceil(this.searchResults.length/this.pageSize)-1&&this.currentPage++},gotoPage:function(){this.inputPage<1?this.inputPage=1:this.inputPage>this.totalPage&&(this.inputPage=this.totalPage),this.currentPage=this.inputPage-1},showExtraInfo:function(t){this.hoveredCategoryId=t.id},hideExtraInfo:function(){this.hoveredCategoryId=null},getCategory:function(){var t=this;Object(s.a)().then(function(e){t.DatabaseObj=e.filter(function(t){return-1===t.pid}),t.selectedDatabaseName=t.DatabaseObj[t.selectedDatabase-1].name,t.selectedDatabasePrice=t.DatabaseObj[t.selectedDatabase-1].price,t.CategoryObj=e.filter(function(e){return e.pid==t.selectedDatabase}),t.CategoryObj.forEach(function(t){var e=t.name.split("-");t.name=e[e.length-1]}),t.CategoryObjMinID=t.CategoryObj[0].id,t.CategoryAll=e,t.sendSearchText()})},handleCategoryClick:function(t){this.selectedCategory=t.id,this.selectedCategoryName=t.name,this.listMiniCategory(),this.sendSearchText()},handleMiniCategoryClick:function(t){this.selectedMiniCategory=t.id,this.selectedMiniCategoryName=t.name,this.sendSearchText()},listCategory:function(){this.selectedCategory=this.selectedDatabase,this.listMiniCategory(),this.sendSearchText()},listMiniCategory:function(){this.selectedMiniCategory=this.selectedMiniDatabase,this.getMiniCategory()},getCoverImg:function(t){return"../../static/coverImg/"+t},gotoDetail:function(t){var e=this,a=localStorage.getItem("userInfo");if(a){var n={userId:JSON.parse(a).id,contentId:t};this.$http.post("/shoppingcase/verifyShoppingCase",n).then(function(a){if(200==a.data.code){var n=e.$router.resolve({path:"/DetailData?id="+t});window.open(n.href)}else e.$alert("您尚未购买该数据！","提示",{confirmButtonText:"确定",callback:function(t){}})}).catch(function(t){console.error(t)})}else this.$confirm("您还未登录，是否进入登录界面?","登录提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$router.push({path:"/Login?login=1"})}).catch(function(){})},gotoPayment:function(t){var e=this.$router.resolve({path:"/Payment",query:{contentId:t.id,price:t.price,caseType:"01"}});window.open(e.href)},gotoPaymentOfDatabase:function(t){var e=this,a=localStorage.getItem("userInfo");if(a){var n={userId:JSON.parse(a).id,contentId:t};this.$http.post("/shoppingcase/verifyShoppingCase",n).then(function(a){if(200==a.data.code)if("VIP"==a.data.data||"ADMIN"==a.data.data)e.$alert("您无需包库！","提示",{confirmButtonText:"确定",callback:function(t){}});else{var n=e.$router.resolve({path:"/Payment",query:{contentId:t,price:e.selectedDatabasePrice,caseType:"02"}});window.open(n.href)}else{var i=e.$router.resolve({path:"/Payment",query:{contentId:t,price:e.selectedDatabasePrice,caseType:"02"}});window.open(i.href)}}).catch(function(t){console.error(t)})}else this.$confirm("您还未登录，是否进入登录界面?","登录提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$router.push({path:"/Login?login=1"})}).catch(function(){})},getMiniCategory:function(){var t=this,e={categoryId:this.selectedCategory};this.$http.post("/category/getMiniCategoryList",e).then(function(e){t.MiniCategoryObj=e.data.data}).catch(function(t){console.error(t)})},sendSearchText:function(){var t=this,e=this.searchText,a={searchContent:e,categoryId:this.selectedMiniCategory?this.selectedMiniCategory:this.selectedCategory};this.searchTextShow=e,this.$http.post("/content/search",a).then(function(e){t.searchResults=e.data.data,t.getTotalPage()}).catch(function(t){console.error(t)})},searchByTag:function(t){var e=this,a={tagName:t};this.searchTextShow="",this.$http.post("/content/searchByTag",a).then(function(t){e.searchResults=t.data.data,e.getTotalPage()}).catch(function(t){console.error(t)})},splitKeyWord:function(t){return t.split(";")},getCategoryName:function(t){return null==t?"":this.CategoryAll.filter(function(e){return e.id===t})[0].name},collectData:function(t){var e=this,a=localStorage.getItem("userInfo");a?this.$confirm("是否添加进您的收藏列表?","收藏提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var n={userId:JSON.parse(a).id,contentId:t};e.$http.post("/collect/collect",n).then(function(t){200==t.data.code?e.$alert("收藏成功！","提示",{confirmButtonText:"确定",callback:function(t){}}):e.$alert("收藏失败,您的收藏列表中已存在该数据！","提示",{confirmButtonText:"确定",callback:function(t){}})}).catch(function(t){console.error(t)})}).catch(function(){}):this.$confirm("您还未登录，是否进入登录界面?","登录提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$router.push({path:"/Login?login=1"})}).catch(function(){})},shoppingOption:function(t){var e=this,a=localStorage.getItem("userInfo");a?this.$confirm("是否添加进您的购物车列表?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var n={userId:JSON.parse(a).id,contentId:t};e.$http.post("/shopping/addToShoppingCar",n).then(function(t){200==t.data.code?e.$alert("添加成功！","提示",{confirmButtonText:"确定",callback:function(t){}}):e.$alert("添加失败，该数据已添加进购物车或您已有浏览权限！","提示",{confirmButtonText:"确定",callback:function(t){}})}).catch(function(t){console.error(t)})}).catch(function(){}):this.$confirm("您还未登录，是否进入登录界面?","登录提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$router.push({path:"/Login?login=1"})}).catch(function(){})},checkInCarOrCollection:function(t){var e=localStorage.getItem("userInfo");if(!e)return 0;var a={userId:JSON.parse(e).id,contentId:t};this.$http.post("/content/checkDataInCarOrCollection",a).then(function(t){t.data.code}).catch(function(t){console.error(t)})}},components:{"boji-navbar":n.a,"boji-webinfo":i.a}}),r={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"background-container"},[a("boji-navbar"),t._v(" "),t._m(0),t._v(" "),a("div",{staticClass:"floating-element",on:{click:function(e){return t.gotoPaymentOfDatabase(t.selectedDatabase)}}},[a("div",{staticClass:"vertical-text"},[t._v("点  击  包  库")])]),t._v(" "),a("div",{staticClass:"introDatabase"},[a("div",{staticClass:"searchTitle"},[t._v("搜             索  :  "+t._s(t.selectedDatabaseName))]),t._v(" "),a("div",{staticClass:"searchResult-bar"},[a("el-input",{staticClass:"search-input",attrs:{placeholder:"请输入搜索内容",rows:20},model:{value:t.searchText,callback:function(e){t.searchText=e},expression:"searchText"}}),t._v(" "),a("el-button",{staticClass:"search-button",attrs:{type:"primary"},on:{click:t.sendSearchText}},[t._v("搜索")])],1),t._v(" "),a("div",{staticClass:"subcategoryContainer"},[a("div",{class:["subCategoryBox",{active:t.selectedDatabase===t.selectedCategory}],on:{click:t.listCategory}},[t._v("不限")]),t._v(" "),t._l(t.CategoryObj,function(e){return a("div",{key:e.id,class:["subCategoryBox",{active:e.id===t.selectedCategory}],on:{click:function(a){return t.handleCategoryClick(e)}}},[a("span",{staticClass:"database-name"},[t._v(t._s(e.name))])])})],2),t._v(" "),"1"==t.selectedDatabase?a("div",{staticClass:"subcategoryContainer",staticStyle:{display:"flex","flex-wrap":"wrap","margin-bottom":"20px","overflow-y":"visible",height:"auto"}},t._l(t.MiniCategoryObj,function(e){return a("div",{key:e.id,class:["miniCategoryBox",{active:e.id===t.selectedMiniCategory}],staticStyle:{"flex-basis":"calc(12.5% - 10px)",margin:"5px",position:"relative"},on:{mouseover:function(a){return t.showExtraInfo(e)},mouseleave:t.hideExtraInfo,click:function(a){return t.handleMiniCategoryClick(e)}}},[a("span",{staticClass:"database-name"},[t._v(t._s(e.name))]),t._v(" "),t.hoveredCategoryId===e.id?a("span",{staticClass:"extra-info",staticStyle:{position:"absolute",top:"90%","background-color":"#fff",padding:"5px",border:"1px solid #ccc","z-index":"2"}},[t._v(t._s(e.description))]):t._e()])}),0):t._e()]),t._v(" "),a("div",{staticClass:"searchResult-container"},[a("div",{staticClass:"informationBox"},[""!==t.searchTextShow?a("p",[t._v("搜索内容 ： "+t._s(t.searchTextShow)),a("br")]):t._e(),a("p",[t._v("结果 : "+t._s(this.searchResults.length)+" 条")])]),t._v(" "),a("div",{staticClass:"resultNav"},[a("div",{staticClass:"navpreImg"},[t._v("预览图")]),t._v(" "),a("div",{staticClass:"navId"},[t._v("编号")]),t._v(" "),a("div",{staticClass:"navId"},[t._v("标题")]),t._v(" "),"1"==t.selectedDatabase?a("div",{staticClass:"navId"},[t._v("户名")]):t._e(),t._v(" "),"1"!=t.selectedDatabase?a("div",{staticClass:"navId"},[t._v("类别")]):t._e(),t._v(" "),a("div",{staticClass:"navId"},[t._v("关键词")]),t._v(" "),a("div",{staticClass:"navId"},[t._v("时间年份")]),t._v(" "),a("div",{staticClass:"navId"})]),t._v(" "),a("div",{staticStyle:{width:"100%",height:"auto"}},[a("div",{staticClass:"currentResultBox"},[t._l(t.currentPageData,function(e,n){return a("div",{key:e.id,staticClass:"dataShowBox"},[a("div",{staticClass:"resultPreImg",on:{click:function(a){return t.gotoDetail(e.id)}}},[a("el-image",{staticClass:"Img",staticStyle:{width:"85%",height:"85%","object-fit":"contain"},attrs:{src:t.getCoverImg(e.introimage),fit:"contain"}})],1),t._v(" "),a("div",{staticClass:"resultAttr",domProps:{innerHTML:t._s(t.formattedText(e.dataid))},on:{click:function(a){return t.gotoDetail(e.id)}}}),t._v(" "),a("div",{staticClass:"resultAttr",on:{click:function(a){return t.gotoDetail(e.id)}}},[a("div",{domProps:{innerHTML:t._s(t.formattedText(e.title))}})]),t._v(" "),"1"!=t.selectedDatabase?a("div",{staticClass:"resultAttr",on:{click:function(a){return t.gotoDetail(e.id)}}},[t._v(t._s(t.getCategoryName(e.typeId)))]):t._e(),t._v(" "),"1"==t.selectedDatabase?a("div",{staticClass:"resultAttr",on:{click:function(a){return t.gotoDetail(e.id)}}},[t._v(t._s(t.getCategoryName(e.minicategory)))]):t._e(),t._v(" "),a("div",{staticClass:"resultAttr"},t._l(t.splitKeyWord(e.remark1),function(e,n){return a("span",{on:{click:function(a){return t.searchByTag(e)}}},[a("div",{domProps:{innerHTML:t._s(t.formattedText(e)+";")}})])}),0),t._v(" "),a("div",{staticClass:"resultAttr",staticStyle:{width:"13%"},domProps:{innerHTML:t._s(t.formattedText(e.yeartime))},on:{click:function(a){return t.gotoDetail(e.id)}}}),t._v(" "),a("div",{staticClass:"resultAttr",staticStyle:{"flex-direction":"row",padding:"0",margin:"0"}},[a("a",{staticClass:"tcolors",staticStyle:{color:"rgb(184, 121, 39)","text-decoration":"underline","text-underline-offset":"8px","margin-right":"10px","font-size":"20px"},on:{click:function(a){return t.gotoPayment(e)}}},[t._v(" ¥ "+t._s(e.price/100)+"元")]),t._v(" "),a("el-button",{staticClass:"shoppingcar-button",staticStyle:{margin:"0","background-color":"transparent",color:"burlywood","font-size":"36px","border-color":"transparent"},attrs:{type:"primary"},on:{click:function(a){return t.shoppingOption(e.id)}}},[a("i",{staticClass:"el-icon-shopping-cart-2"})]),t._v(" "),a("el-button",{staticClass:"colllect-button",staticStyle:{"margin-left":"0","background-color":"transparent",color:"darkgoldenrod","font-size":"36px","border-color":"transparent"},attrs:{type:"primary"},on:{click:function(a){return t.collectData(e.id)}}},[a("i",{staticClass:"el-icon-star-off"})])],1)])}),t._v(" "),a("div",{staticClass:"pageGuideBox"},[t.searchResults.length>0?a("div",[a("span",[t._v("当前页: "+t._s(t.currentPage+1)+" / 总页数: "+t._s(t.totalPage))]),t._v(" "),a("el-button",{staticStyle:{"margin-left":"20px"},attrs:{type:"small",disabled:0===t.currentPage},on:{click:t.prevPage}},[t._v("上一页")]),t._v(" "),a("el-button",{attrs:{type:"small",disabled:t.currentPage+1===t.totalPage},on:{click:t.nextPage}},[t._v("下一页")]),t._v(" "),a("el-input",{staticStyle:{width:"15%"},attrs:{type:"number",min:"1",max:t.totalPage,rows:20},on:{change:t.gotoPage},model:{value:t.inputPage,callback:function(e){t.inputPage=e},expression:"inputPage"}})],1):t._e()])],2)])])],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"navBox"},[e("div",{staticClass:"logoBox"})])}]};var c=a("VU/8")(o,r,!1,function(t){a("CVS6")},"data-v-d01465d2",null);e.default=c.exports}});