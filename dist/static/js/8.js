webpackJsonp([8],{AUBU:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s,n=a("bOdI"),i=a.n(n),c=a("Cz8s"),r=a("p/61"),o=a("s8Ph"),l=a("1pQF"),u=(a("mtWM"),{name:"Collection",data:function(){return{userInfo:"",searchText:"",showSearchResults:!1,searchedPosts:[],browseList:"",searchResults:[],selectedDatabase:1,DatabaseObj:{},SubCategoryObj:{},CategoryAll:{},totalPage:10,pageSize:4,currentPage:0,inputPage:1,selectedItems:[],totalPrice:0,selectAll:!1}},created:function(){var t=this,e=localStorage.getItem("userInfo");this.userInfo=JSON.parse(e),this.getCategory();var a={userId:this.userInfo.id};this.$http.post("/shopping/searchShoppingCarByUser",a).then(function(e){200==e.data.code&&(t.searchResults=e.data.data,t.getTotalPage())}).catch(function(t){console.error(t)})},mounted:function(){this.selectedDatabase=this.DatabaseObj[0]},computed:{databasePosts:function(){var t=this;return this.posts.filter(function(e){return e.databaseId===t.selectedDatabase.id})},currentPageData:function(){var t=this.currentPage*this.pageSize,e=t+this.pageSize;return this.searchResults.slice(t,e)}},methods:(s={handleCheckboxChange:function(){console.log("选中的项目ID:",this.selectedItems),this.selectedItems.length<this.currentPageData.length?this.selectAll=!1:this.selectedItems.length==this.currentPageData.length&&(this.selectAll=!0)},getTotalPage:function(){this.totalPage=Math.ceil(this.searchResults.length/this.pageSize)},prevPage:function(){this.currentPage>0&&this.currentPage--},nextPage:function(){this.currentPage<Math.ceil(this.searchResults.length/this.pageSize)-1&&this.currentPage++},gotoPage:function(){this.inputPage<1?this.inputPage=1:this.inputPage>this.totalPage&&(this.inputPage=this.totalPage),this.currentPage=this.inputPage-1},getTotalPrice:function(t){var e=0;return t.forEach(function(t){e+=t.price}),e},gotoDetail:function(t){var e=this,a=localStorage.getItem("userInfo");if(a){var s={userId:JSON.parse(a).id,contentId:t};this.$http.post("/shoppingcase/verifyShoppingCase",s).then(function(a){if(200==a.data.code){var s=e.$router.resolve({path:"/DetailData?id="+t});window.open(s.href)}else e.$alert("您尚未购买该数据！","提示",{confirmButtonText:"确定",callback:function(t){}})}).catch(function(t){console.error(t)})}else this.$confirm("您还未登录，是否进入登录界面?","登录提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$router.push({path:"/Login?login=1"})}).catch(function(){})},getCoverImg:function(t){return"../../static/coverImg/"+t},getCategoryName:function(t){return this.SubCategoryObj.filter(function(e){return e.id==t})[0].name},getCategory:function(){var t=this;Object(o.a)().then(function(e){t.DatabaseObj=e.filter(function(t){return-1===t.pid}),t.SubCategoryObj=e.filter(function(t){return-1!=t.pid}),t.CategoryAll=e})}},i()(s,"getCategoryName",function(t){return this.CategoryAll.filter(function(e){return e.id===t})[0].name}),i()(s,"handleDatabaseClick",function(t){this.selectedDatabase=t}),i()(s,"showInitDate",function(t,e){return Object(l.a)(t,e)}),i()(s,"sendSearchText",function(){this.$router.push({path:"/SearchResult",query:{q:this.searchText,Database:this.selectedDatabase.id}})}),i()(s,"splitKeyWord",function(t){return t.split(";")}),i()(s,"searchByTag",function(t){var e=this;this.isShowCategory=!1;var a={tagName:t};this.showSearchResults=!0,this.searchTextShow="",this.$http.post("/content/searchByTag",a).then(function(t){e.searchResults=t.data.data,e.getTotalPage()}).catch(function(t){console.error(t)})}),i()(s,"gotoPayment",function(t){var e=this.$router.resolve({path:"/Payment",query:{contentId:t.id,price:t.price,caseType:"01"}});window.open(e.href)}),i()(s,"gotoBatchPayment",function(){console.log("BatchPayment!"),console.log("Total price: "+this.totalPrice)}),i()(s,"handleSelectAll",function(){this.selectAll?this.selectedItems=this.currentPageData.slice():this.selectedItems=[]}),i()(s,"commitShopping",function(){if(!(this.selectedItems.length<=0)){console.log(this.selectedItems);var t=this.selectedItems.map(function(t){return t.id}).join(",");if(1==this.selectedItems.length){var e=this.$router.resolve({path:"/Payment",query:{contentId:t,price:this.selectedItems[0].price,caseType:"01"}});window.open(e.href)}else{var a=this.$router.resolve({path:"/Payment",query:{contentId:t,price:9999,caseType:"04"}});window.open(a.href)}}}),i()(s,"deleteFromShoppingCar",function(t){var e=this,a=localStorage.getItem("userInfo");a?this.$confirm("是否在您的购物车中删除该数据?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var s={userId:JSON.parse(a).id,contentId:t};e.$http.post("/shopping/deleteShoppingCarInfo",s).then(function(t){200==t.data.code?e.$alert("删除成功！","提示",{confirmButtonText:"确定",callback:function(t){}}):e.$alert("删除失败！","提示",{confirmButtonText:"确定",callback:function(t){}}),location.reload()}).catch(function(t){console.error(t)})}).catch(function(){}):this.$confirm("您还未登录，是否进入登录界面?","登录提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$router.push({path:"/Login?login=1"})}).catch(function(){})}),s),components:{"boji-navbar":c.a,"boji-webinfo":r.a}}),h={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"background-container"},[a("boji-navbar"),t._v(" "),t._m(0),t._v(" "),a("div",{staticClass:"titleBox"},[t._v(t._s(this.userInfo.nickname)+" 的购物车列表")]),t._v(" "),a("div",{staticClass:"shoppingcarBox"},[t._m(1),t._v(" "),a("div",{staticStyle:{width:"100%"}},[a("div",{staticClass:"currentResultBox"},[t._l(t.currentPageData,function(e,s){return a("div",{key:e.id,staticClass:"dataShowBox"},[a("label",{staticClass:"custom-checkbox"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.selectedItems,expression:"selectedItems"}],staticClass:"checkbox",attrs:{type:"checkbox"},domProps:{value:e,checked:Array.isArray(t.selectedItems)?t._i(t.selectedItems,e)>-1:t.selectedItems},on:{change:[function(a){var s=t.selectedItems,n=a.target,i=!!n.checked;if(Array.isArray(s)){var c=e,r=t._i(s,c);n.checked?r<0&&(t.selectedItems=s.concat([c])):r>-1&&(t.selectedItems=s.slice(0,r).concat(s.slice(r+1)))}else t.selectedItems=i},t.handleCheckboxChange]}}),t._v(" "),a("span",{staticClass:"checkmark"})]),t._v(" "),a("div",{staticClass:"resultPreImg",on:{click:function(a){return t.gotoDetail(e.id)}}},[a("el-image",{staticClass:"Img",staticStyle:{width:"85%",height:"85%","object-fit":"contain"},attrs:{src:t.getCoverImg(e.introimage),fit:"contain"}})],1),t._v(" "),a("div",{staticClass:"resultAttr",on:{click:function(a){return t.gotoDetail(e.id)}}},[t._v(t._s(e.dataid))]),t._v(" "),a("div",{staticClass:"resultAttr",on:{click:function(a){return t.gotoDetail(e.id)}}},[t._v(t._s(e.title))]),t._v(" "),a("div",{staticClass:"resultAttr",on:{click:function(a){return t.gotoDetail(e.id)}}},[t._v(t._s(t.getCategoryName(e.typeId)))]),t._v(" "),a("div",{staticClass:"resultAttr"},t._l(t.splitKeyWord(e.remark1),function(e,s){return a("span",[t._v(t._s(e)+";")])}),0),t._v(" "),a("div",{staticClass:"resultAttr",staticStyle:{width:"11%"},on:{click:function(a){return t.gotoDetail(e.id)}}},[t._v(t._s(e.yeartime))]),t._v(" "),a("div",{staticClass:"resultAttr",staticStyle:{"flex-direction":"row",width:"16%"}},[a("el-button",{staticClass:"delete-button",staticStyle:{"margin-left":"10px","background-color":"transparent",color:"brown","font-size":"36px","border-color":"transparent"},attrs:{type:"primary"},on:{click:function(a){return t.deleteFromShoppingCar(e.id)}}},[a("i",{staticClass:"el-icon-delete"})]),t._v(" "),a("el-button",{staticClass:"delete-button",staticStyle:{"background-color":"transparent",color:"orange","font-size":"36px","border-color":"transparent"},attrs:{type:"primary"},on:{click:function(a){return t.gotoPayment(e)}}},[a("i",{staticClass:"el-icon-goods"})])],1)])}),t._v(" "),a("div",{staticClass:"totalPay"},[a("div",{staticClass:"leftBox",staticStyle:{width:"50%",height:"100%","background-color":"transparent",display:"flex","justify-content":"left","align-items":"center"}},[a("div",{staticClass:"selectAllBox",staticStyle:{display:"flex","align-items":"center",width:"50%","padding-left":"3%"}},[a("label",{staticClass:"custom-checkbox"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.selectAll,expression:"selectAll"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.selectAll)?t._i(t.selectAll,null)>-1:t.selectAll},on:{change:[function(e){var a=t.selectAll,s=e.target,n=!!s.checked;if(Array.isArray(a)){var i=t._i(a,null);s.checked?i<0&&(t.selectAll=a.concat([null])):i>-1&&(t.selectAll=a.slice(0,i).concat(a.slice(i+1)))}else t.selectAll=n},t.handleSelectAll]}}),t._v(" "),a("span",{staticClass:"checkmark"})]),t._v(" "),a("span",{staticStyle:{"margin-left":"20px"}},[t._v("全选")])])]),t._v(" "),a("div",{staticClass:"rightBox",staticStyle:{width:"50%",height:"100%","background-color":"transparent",display:"flex","justify-content":"right","align-items":"center"}},[a("a",{staticClass:"tcolors",staticStyle:{color:"rgb(184, 121, 39)","margin-left":"20px","text-decoration":"underline","text-underline-offset":"4px"},on:{click:function(e){return t.gotoBatchPayment()}}},[t._v(" ¥ "+t._s(t.getTotalPrice(t.selectedItems)/100)+"元")]),t._v(" "),a("el-button",{staticClass:"delete-button",staticStyle:{"margin-left":"30px"},attrs:{type:"warning",round:""},on:{click:t.commitShopping}},[t._v("结 算")])],1)]),t._v(" "),a("div",{staticClass:"pageGuideBox"},[t.searchResults.length>0?a("div",[a("span",[t._v("当前页: "+t._s(t.currentPage+1)+" / 总页数: "+t._s(t.totalPage))]),t._v(" "),a("el-button",{staticStyle:{"margin-left":"20px"},attrs:{type:"small",disabled:0===t.currentPage},on:{click:t.prevPage}},[t._v("上一页")]),t._v(" "),a("el-button",{attrs:{type:"small",disabled:t.currentPage+1===t.totalPage},on:{click:t.nextPage}},[t._v("下一页")]),t._v(" "),a("el-input",{staticStyle:{width:"15%"},attrs:{type:"number",min:"1",max:t.totalPage,rows:20},on:{change:t.gotoPage},model:{value:t.inputPage,callback:function(e){t.inputPage=e},expression:"inputPage"}})],1):t._e()])],2)])]),t._v(" "),a("boji-webinfo")],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"navBox"},[e("div",{staticClass:"logoBox"})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"resultNav"},[a("div",{staticClass:"navpreImg",staticStyle:{"margin-left":"4%"}},[t._v("预览图")]),t._v(" "),a("div",{staticClass:"navId"},[t._v("编号")]),t._v(" "),a("div",{staticClass:"navId"},[t._v("标题")]),t._v(" "),a("div",{staticClass:"navId"},[t._v("类别")]),t._v(" "),a("div",{staticClass:"navId"},[t._v("关键词")]),t._v(" "),a("div",{staticClass:"navId"},[t._v("时间年份")]),t._v(" "),a("div",{staticClass:"navId"},[t._v("操作")])])}]};var d=a("VU/8")(u,h,!1,function(t){a("we+G")},"data-v-5b4e899c",null);e.default=d.exports},"we+G":function(t,e){}});